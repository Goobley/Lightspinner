from dataclasses import dataclass, field
from typing import List, Sequence, Callable
from enum import Enum, auto
import Constants as Const
from AtomicModel import *



TemperatureGrid = [3000.0, 5000.0, 7000.0, 15000.0, 50000.0, 100000.0]

CaII = AtomicModel(
    name = 'CA',
    levels = \
        [
        AtomicLevel(E=    0.000, g=2.00, label='CA II 3P6 4S 2SE',   stage=1),
        AtomicLevel(E=13650.190, g=4.00, label='CA II 3P6 3D 2DE 3', stage=1),
        AtomicLevel(E=13710.880, g=6.00, label='CA II 3P6 3D 2DE 5', stage=1),
        AtomicLevel(E=25191.510, g=2.00, label='CA II 3P6 4P 2PO 1', stage=1),
        AtomicLevel(E=25414.400, g=4.00, label='CA II 3P6 4P 2PO 3', stage=1),
        AtomicLevel(E=95785.470, g=1.00, label='CA III 3P6 1SE',     stage=2)
        ],

    lines = \
        [
        #         j  i      f      CRD/PRD  Nlambda qcore qwing    vdwApprox    vdwParams        radiative  stark 
        VoigtLine(3, 0, 3.412e-01, LineType.PRD, 50, 30.0, 1500, VdwBarklem([1.5, 1.0]), 1.48e08, 1.0e-00),
        VoigtLine(4, 0, 6.807e-01, LineType.PRD, 50, 30.0, 1500, VdwBarklem([1.5, 1.0]), 1.50e08, 1.0e-00),

        VoigtLine(3, 1, 5.956e-02, LineType.CRD, 40, 4.0, 200.0, VdwBarklem([1.5, 1.0]), 1.48e08, 1.0e-00),
        VoigtLine(4, 1, 1.219e-02, LineType.CRD, 40, 4.0, 150.0, VdwBarklem([1.5, 1.0]), 1.50e08, 1.0e-00),
        VoigtLine(4, 2, 7.242e-02, LineType.CRD, 80, 4.0, 200.0, VdwBarklem([1.5, 1.0]), 1.50e08, 1.0e-00)
        ],

    continua = \
        [
        ExplicitContinuum(5, 0,
                         [[104.4,  2.0363E-23],
                          [100.0,  2.0974E-23],
                          [ 95.0,  2.1455E-23],
                          [ 90.0,  2.1704E-23],
                          [ 85.0,  2.1715E-23],
                          [ 80.0,  2.1489E-23],
                          [ 75.0,  2.1025E-23],
                          [ 70.0,  2.0332E-23],
                          [ 65.0,  1.9419E-23],
                          [ 60.0,  1.8302E-23],
                          [ 55.0,  1.7001E-23],
                          [ 50.0,  1.5539E-23],
                          [ 45.0,  1.3944E-23],
                          [ 40.0,  1.2248E-23],
                          [ 35.0,  1.0486E-23]]),
        ExplicitContinuum(5, 1,
                         [[121.7,  6.1484E-22],
                          [120.0,  6.0860E-22],
                          [115.0,  5.9073E-22],
                          [110.0,  5.7157E-22],
                          [105.0,  5.5114E-22],
                          [100.0,  5.2947E-22],
                          [ 95.0,  5.0663E-22],
                          [ 90.0,  4.8268E-22],
                          [ 85.0,  4.5762E-22],
                          [ 80.0,  4.3150E-22],
                          [ 75.0,  4.0436E-22],
                          [ 70.0,  3.7619E-22],
                          [ 65.0,  3.4701E-22],
                          [ 60.0,  3.1682E-22],
                          [ 55.0,  2.8561E-22],
                          [ 50.0,  2.5339E-22],
                          [ 45.0,  2.2021E-22],
                          [ 40.0,  1.8620E-22],
                          [ 35.0,  1.5169E-22],
                          [ 30.0,  1.1734E-22]]),
        ExplicitContinuum(5, 2,
                         [[121.8,  6.1484E-22],
                          [120.0,  6.0860E-22],
                          [115.0,  5.9073E-22],
                          [110.0,  5.7157E-22],
                          [105.0,  5.5114E-22],
                          [100.0,  5.2947E-22],
                          [ 95.0,  5.0663E-22],
                          [ 90.0,  4.8268E-22],
                          [ 85.0,  4.5762E-22],
                          [ 80.0,  4.3150E-22],
                          [ 75.0,  4.0436E-22],
                          [ 70.0,  3.7619E-22],
                          [ 65.0,  3.4701E-22],
                          [ 60.0,  3.1682E-22],
                          [ 55.0,  2.8561E-22],
                          [ 50.0,  2.5339E-22],
                          [ 45.0,  2.2021E-22],
                          [ 40.0,  1.8620E-22],
                          [ 35.0,  1.5169E-22],
                          [ 30.0,  1.1734E-22]]),
        ExplicitContinuum(5, 3,
                         [[141.7,  2.3823E-22],
                          [140.0,  2.2664E-22],
                          [135.0,  1.9921E-22],
                          [130.0,  1.7407E-22],
                          [125.0,  1.5113E-22],
                          [120.0,  1.3031E-22],
                          [115.0,  1.1152E-22],
                          [110.0,  9.4650E-23],
                          [105.0,  7.9613E-23],
                          [100.0,  6.6309E-23],
                          [ 95.0,  5.4640E-23],
                          [ 90.0,  4.4507E-23],
                          [ 85.0,  3.5808E-23],
                          [ 80.0,  2.8438E-23],
                          [ 75.0,  2.2293E-23],
                          [ 70.0,  1.7266E-23],
                          [ 65.0,  1.3249E-23],
                          [ 60.0,  1.0130E-23]]),
        ExplicitContinuum(5, 4,
                         [[142.1,  2.3823E-22],
                          [140.0,  2.2664E-22],
                          [135.0,  1.9921E-22],
                          [130.0,  1.7407E-22],
                          [125.0,  1.5113E-22],
                          [120.0,  1.3031E-22],
                          [115.0,  1.1152E-22],
                          [110.0,  9.4650E-23],
                          [105.0,  7.9613E-23],
                          [100.0,  6.6309E-23],
                          [ 95.0,  5.4640E-23],
                          [ 90.0,  4.4507E-23],
                          [ 85.0,  3.5808E-23],
                          [ 80.0,  2.8438E-23],
                          [ 75.0,  2.2293E-23],
                          [ 70.0,  1.7266E-23],
                          [ 65.0,  1.3249E-23],
                          [ 60.0,  1.0130E-23]]),
        ],

    collisions = \
        [
            Omega(1, 0, TemperatureGrid,
                        [2.378E+00, 2.284E+00, 2.203E+00, 1.920E+00, 1.961E+00, 1.846E+00]),
            Omega(2, 0, TemperatureGrid,
                        [3.568E+00, 3.426E+00, 3.304E+00, 2.879E+00, 2.942E+00, 2.770E+00]),
            Omega(2, 1, TemperatureGrid,
                        [1.778E+00, 2.869E+00, 4.693E+00, 1.266E+01, 3.189E+00, 7.926E+00]),
            Omega(3, 0, TemperatureGrid,
                        [4.842E+00, 5.288E+00, 5.548E+00, 6.148E+00, 8.482E+00, 1.200E+01]),
            Omega(4, 0, TemperatureGrid,
                        [9.683E+00, 1.058E+01, 1.110E+01, 1.230E+01, 1.696E+01, 2.401E+01]),
            Omega(4, 3, TemperatureGrid,
                        [8.511E-01, 1.364E+00, 1.878E+00, 4.002E+00, 1.111E+01, 1.873E+01]),
            Omega(3, 1, TemperatureGrid,
                        [1.360E+01, 1.433E+01, 1.496E+01, 1.699E+01, 2.280E+01, 2.836E+01]),
            Omega(4, 1, TemperatureGrid,
                        [6.316E+00, 6.488E+00, 6.623E+00, 7.033E+00, 8.080E+00, 8.899E+00]),
            Omega(3, 2, TemperatureGrid,
                        [4.338E+00, 4.282E+00, 4.203E+00, 3.929E+00, 3.315E+00, 2.641E+00]),
            Omega(4, 2, TemperatureGrid,
                        [2.504E+01, 2.636E+01, 2.751E+01, 3.122E+01, 4.217E+01, 5.284E+01]),
            CI(i=0, j=5, temperature=TemperatureGrid,
                     rates=[4.580E-18, 4.580E-18, 4.580E-18, 4.580E-18, 4.580E-18, 4.580E-18]),
            CI(i=1, j=5, temperature=TemperatureGrid, 
                     rates=[1.613E-16, 1.613E-16, 1.613E-16, 1.613E-16, 1.613E-16, 1.613E-16]),
            CI(i=2, j=5, temperature=TemperatureGrid,
                     rates=[1.614E-16, 1.614E-16, 1.614E-16, 1.614E-16, 1.614E-16, 1.614E-16]),
            CI(i=3, j=5, temperature=TemperatureGrid,
                     rates=[7.272E-17, 7.272E-17, 7.272E-17, 7.272E-17, 7.272E-17, 7.272E-17]),
            CI(i=4, j=5, temperature=TemperatureGrid,
                     rates=[7.295E-17, 7.295E-17, 7.295E-17, 7.295E-17, 7.295E-17, 7.295E-17])
        ])

    